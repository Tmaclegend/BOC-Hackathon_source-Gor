<!DOCTYPE html>
<html>
<head>
	<title>Join</title>
</head>
<body>
	<h1>Join Queue</h1>
	<form onsubmit="makeJSON(this)" class="joinqueue">
		<!-- <label for="Qpos">Qpos: </label>
		<input type="number" name="Qpos" class="Qform"><br> -->
		<label for="customerId">customerId: </label>
		<input type="text" name="customerId" class="Qform"><br>

		<label for="phone">Phone: </label>
		<input type="text" name="phone" class="Qform"><br>

		<label for="service">Service: </label>
		<select name="service" class="Qform">

			<option value="withdrawal">Withdrawal</option>
			<option value="deposit">Deposit</option>
			<option value="transfer">Transfer</option>
		</select><br>
		<label for="branch">Branch: </label>
		<select name="branch" class="Qform">
			<option value="KF">Kwai Fong</option>
			<option value="MK">Mong Kok</option>
			<option value="TP">Tai Po</option>
		</select><br>
		<input type="submit" name="Submit">
	</form>

	<div>
		<h1>Send JSON to Node</h1>
		<button onClick="sendJSON()">Send</button>
		<p id ="result">
		</p>
	</div>

	<script>

		// var myData = [
		// {
		// 	"name": "Bill",
		// 	"age": 20
		// },
		// {
		// 	"name": "Lisa",
		// 	"age": 40
		// },
		// {
		// 	"name": "Ant",
		// 	"age": 80
		// }
		// ]
		function makeJSON(form){
			var objects = []; 
			if (typeof form == 'object' && form.nodeName.toLowerCase() == "form") {  
				var fields = form.getElementsByClassName("Qform");  
				
				for(var i=0;i<fields.length;i++){  
					objects[objects.length] = { name: fields[i].getAttribute("name"), value: fields[i].value };  
				}  
			}  
			console.log(objects);
			var jsonData = JSON.stringify(objects);  
			console.log(jsonData);
// return objects;  
var xmlhttp = new XMLHttpRequest();   // new HttpRequest instance
xmlhttp.onreadystatechange = function() {
	if (this.readyState == 4 && this.status == 200) {
		document.getElementById("result").innerHTML =
		this.responseText;
	}
};
xmlhttp.open("POST", "http://localhost:3000/joinqueue.html");
xmlhttp.setRequestHeader("Content-Type", "application/json;charset=UTF-8");
console.log(objects);
xmlhttp.send(JSON.stringify(objects));
}

// 		function sendJSON(){

// var xmlhttp = new XMLHttpRequest();   // new HttpRequest instance
// xmlhttp.onreadystatechange = function() {
// 	if (this.readyState == 4 && this.status == 200) {
// 		document.getElementById("result").innerHTML =
// 		this.responseText;
// 	}
// };
// xmlhttp.open("POST", "http://localhost:3000/joinqueue.html");
// xmlhttp.setRequestHeader("Content-Type", "application/json;charset=UTF-8");
// xmlhttp.send(JSON.stringify(myData));

// }

</script>
</body>
</html>